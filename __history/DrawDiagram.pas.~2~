unit DrawDiagram;

interface
  uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ExtCtrls;


implementation

uses Types;


procedure DrawBarChart(DiagramBox: TDiagrambox; ColorMode, HeightMode: Boolean);
var
  BarWidth, BarHeight, x1, ExtraDistanz, GreyColor, I: Integer;

begin
  barWidth:= DiagramBox.Box.Width div (length(DiagramBox.Content));
  //ExtraDistanz:= BarWidth div length(DiagramBox.Content);
  ExtraDistanz:= 0;
  x1:= DiagramBox.Box.x;
  with DiagramBox.Box.Bitmap.Canvas do
  begin
    Brush.Color:= clWhite;
    Pen.Color:= clWhite;
    Rectangle(DiagramBox.Box.x,DiagramBox.Box.y, DiagramBox.Box.Width, DiagramBox.Box.Height);

    MoveTo(DiagramBox.Box.x, DiagramBox.Box.Height+DiagramBox.Box.y);
    GreyColor:= 140;
    Pen.Style:= psSolid;
    Pen.Color:= rgb(GreyColor, GreyColor, GreyColor);
    LineTo(DiagramBox.Box.Width+DiagramBox.Box.x, DiagramBox.Box.Height+DiagramBox.Box.y);

    GreyColor:= 190;
    Pen.Style:= psDot;
    Pen.Color:= rgb(GreyColor, GreyColor, GreyColor);

    MoveTo(DiagramBox.Box.x, Round(DiagramBox.Box.Height * 1/4)+DiagramBox.Box.y);
    LineTo(DiagramBox.Box.Width+DiagramBox.Box.x, Round(DiagramBox.Box.Height * 1/4)+DiagramBox.Box.y);

    MoveTo(DiagramBox.Box.x, Round(DiagramBox.Box.Height * 2/4)+DiagramBox.Box.y);
    LineTo(DiagramBox.Box.Width+DiagramBox.Box.x, Round(DiagramBox.Box.Height * 2/4)+DiagramBox.Box.y);

    MoveTo(DiagramBox.Box.x, Round(DiagramBox.Box.Height * 3/4)+DiagramBox.Box.y);
    LineTo(DiagramBox.Box.Width+DiagramBox.Box.x, Round(DiagramBox.Box.Height * 3/4)+DiagramBox.Box.y);


    if DiagramBox.SelectedItem = 10000 then
    begin
      Pen.Style:= psSolid;
      Pen.Color:= clwhite;
      Brush.Color:= rgb(88, 206, 162);


      for I := 0 to length(DiagramBox.Content)-1 do
      begin
        BarHeight:= (DiagramBox.Box.Height div DiagramBox.MaxNum)*DiagramBox.Content[i];
        Rectangle(x1, DiagramBox.Box.Height+DiagramBox.Box.y, x1+barWidth, DiagramBox.Box.Height-BarHeight+DiagramBox.Box.y);
        x1:= x1+BarWidth+ExtraDistanz;
      end;
    end

    else
    begin
      Pen.Style:= psSolid;
      Pen.Color:= clwhite;
      Brush.Color:= rgb(233, 233, 233);

      for I := 0 to length(DiagramBox.Content)-1 do
      begin
        if I = DiagramBox.SelectedItem then Brush.Color:= rgb(88, 206, 162)
        else Brush.Color:= rgb(233, 233, 233);

        BarHeight:= (DiagramBox.Box.Height div DiagramBox.MaxNum)*DiagramBox.Content[i];
        Rectangle(x1, DiagramBox.Box.Height, x1+barWidth, DiagramBox.Box.Height-BarHeight);
        x1:= x1+BarWidth+ExtraDistanz;
      end;
    end;

  end;
end;

end.


