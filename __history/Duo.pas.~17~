unit Duo;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ExtCtrls, Vcl.StdCtrls,
  Vcl.Imaging.pngimage, Types, CreateObjects, QuickSort, SliderSelector;

  var
    DuoDiagrambox1, DuoDiagrambox2: TDiagramBox;
    DuoDiagrambox1Image, DuoDiagrambox2Image: TImage;
    DuoDiagrambox1Bitmap, DuoDiagrambox2Bitmap: TBitmap;

    DuoNumberlist: TNewListbox;
    DuoNumberlistImage: TImage;
    DuoNumberlistBitmap: TBitmap;

    DuoSettingsBox: TSettings;
    DuoSettingsBoxImage: TImage;
    DuoSettingsBoxBitmap: TBitmap;
    DuoSettingsSelector1, DuoSettingsSelector2, DuoSettingsSelector3: TImage;

    DuoSortButton: TCustomButton;
    DuoSortButtonImage: TImage;
    DuoSortButtonBitmap: TBitmap;

    DuoEditArrayLength: TEditField;
    DuoEditSpeed: TEditField;
    DuoEditMaxNum: TEditField;

    ArrayNumber: TArrayOfInteger;
    MaxNum: Integer = 30;
    DuoSettingsOpened: Boolean;

    procedure CreateDuo();
    procedure DrawDuo();
    procedure DestroyDuo();
    procedure DuoScroll(WheelData: Integer);
    procedure DuoPress();

implementation

uses MainUnit, DrawUI, DrawDiagram, Sorting, OpenImage, ReadLanguage, EditField, Convert,
      OpenSettings;


procedure DuoScroll(WheelData: Integer);
begin
  if MainForm.CursorIsInArea(DuoNumberlist.Area) then
  begin
    NewListboxScroll(DuoNumberlist, Wheeldata div 120 + DuoNumberlist.ScrollLevel);
  end;
end;

procedure DuoPress();
begin
  if DuoSettingsOpened then
  begin
    TThread.CreateAnonymousThread(
        procedure
        begin
          DuoSettingsOpened:= false;
          OpenSettings.AnimateSettings(false);
        end
        ).Start();
  end
  else
  begin
    if MainForm.CursorIsInArea(DuoSettingsBox.DiagramSelector1.Area) then
    begin
      LoadImage('CirclePressed', DuoSettingsBox.DiagramSelector1.Image);
      LoadImage('Bar', DuoSettingsBox.DiagramSelector2.Image);
      LoadImage('Column', DuoSettingsBox.DiagramSelector3.Image);
      DuoDiagrambox1.Diagram.DiagramTyp:= 0;
      DuoDiagrambox2.Diagram.DiagramTyp:= 0;
      DrawDiagramProcedure(DuoDiagrambox1);
      DrawDiagramProcedure(DuoDiagrambox2);
    end
    else if MainForm.CursorIsInArea(DuoSettingsBox.DiagramSelector2.Area) then
    begin
      LoadImage('Circle', DuoSettingsBox.DiagramSelector1.Image);
      LoadImage('BarPressed', DuoSettingsBox.DiagramSelector2.Image);
      LoadImage('Column', DuoSettingsBox.DiagramSelector3.Image);
      DuoDiagrambox1.Diagram.DiagramTyp:= 1;
      DuoDiagrambox2.Diagram.DiagramTyp:= 1;
      DrawDiagramProcedure(DuoDiagrambox1);
      DrawDiagramProcedure(DuoDiagrambox2);
    end
    else if MainForm.CursorIsInArea(DuoSettingsBox.DiagramSelector3.Area) then
    begin
      LoadImage('Circle', DuoSettingsBox.DiagramSelector1.Image);
      LoadImage('Bar', DuoSettingsBox.DiagramSelector2.Image);
      LoadImage('ColumnPressed', DuoSettingsBox.DiagramSelector3.Image);
      DuoDiagrambox1.Diagram.DiagramTyp:= 2;
      DuoDiagrambox2.Diagram.DiagramTyp:= 2;
      DrawDiagramProcedure(DuoDiagrambox1);
      DrawDiagramProcedure(DuoDiagrambox2);
    end
    else if MainForm.CursorIsInArea(DuoSortButton.Area) then
    begin
      TThread.CreateAnonymousThread(
        procedure
        begin
          QuickSortProcedure(ArrayNumber, DuoDiagrambox1, 100);
        end
        ).Start();

      TThread.CreateAnonymousThread(
        procedure
        begin
          QuickSortProcedure(ArrayNumber, DuoDiagrambox2, 100);
        end
        ).Start();
    end
    else if MainForm.CursorIsInArea(DuoSettingsBox.Area) then
    begin
      TThread.CreateAnonymousThread(
        procedure
        begin
          DuoSettingsOpened:= true;
          OpenSettings.AnimateSettings(true);
        end
        ).Start();
    end;
  end;
end;

procedure CreateDuo();
begin
  DuoOpened:= true;
  SetLengthCustom(ArrayNumber, ArrayLength);
  CreateRandomArray(ArrayNumber, MaxNum, ArrayLength);
  DuoDiagrambox1.MaxNum:= 360;
  DuoDiagrambox2.MaxNum:= 360;
  CreateDiagramBox(MainForm, DuoDiagrambox1, 100, 160, 480, 480, ArrayNumber, DuoDiagrambox1Image, DuoDiagrambox1Bitmap, MaxNum, 450, 450, 15, 15);
  CreateDiagramBox(MainForm, DuoDiagrambox2, 610, 160, 480, 480, ArrayNumber, DuoDiagrambox1Image, DuoDiagrambox1Bitmap, MaxNum, 450, 450, 15, 15);
  CreateListbox(MainForm, DuoNumberlist, 'Numberslist', 1120, 100, 650, 100, false, ArrayNumber, DuoNumberlistImage, DuoNumberlistBitmap);
  CreateSettingsBox(MainForm, DuoSettingsBox, 100, 660, 90, 990, DuoSettingsBoxImage, DuoSettingsBoxBitmap, DuoSettingsSelector1, DuoSettingsSelector2, DuoSettingsSelector3, 1);
  CreateCustomButton(MainForm, DuoSortButton, 780, 680, 50, 290, DuoSortButtonImage, DuoSortButtonBitmap, ReadLang('SortButton'));
  CreateEditField(MainForm, DuoEditArrayLength, 360, 680, 50, 130, ReadLang('ArrayLength'), IntToStr(MaxNum));
  CreateEditField(MainForm, DuoEditSpeed, 500, 680, 50, 130, ReadLang('Speed'), IntToStr(MaxNum));
  CreateEditField(MainForm, DuoEditMaxNum, 640, 680, 50, 130, ReadLang('MaxNum'), IntToStr(MaxNum));
  ImageToArea(DuoSettingsBox.Image, DuoSettingsBox.Area);
end;

procedure DrawDuo();
begin
  DrawDiagramProcedure(DuoDiagrambox1);
  DrawDiagramProcedure(DuoDiagrambox2);
  FillListBox(DuoNumberlist);
  DrawSettings(DuoSettingsBox);
  DrawButtonStyle1(DuoSortButton);
  DrawEditField(DuoEditArrayLength);
  DrawEditField(DuoEditSpeed);
  DrawEditField(DuoEditMaxNum);
end;

procedure DestroyDuo();
begin
  DuoOpened:= false;
  DuoDiagrambox1.Image.Free;
  DuoDiagrambox2.Image.Free;
  DuoNumberlist.Image.Free;
  DuoSettingsBox.Image.Free;
  DuoSettingsBox.DiagramSelector1.Image.Free;
  DuoSettingsBox.DiagramSelector2.Image.Free;
  DuoSettingsBox.DiagramSelector3.Image.Free;
  DuoSortButton.Image.Free;
end;

end.
